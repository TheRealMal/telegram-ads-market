System Architecture and Implementation Strategy for a Telegram-Based Decentralized Advertising MarketplaceThe evolution of the Telegram ecosystem has transformed the platform from a conventional messaging service into a comprehensive decentralized operating system. The introduction of Telegram Mini Apps (TMAs) and the deep integration of The Open Network (TON) blockchain provide a unique infrastructure for peer-to-peer commerce. Within this landscape, the creation of an advertising marketplace requires a sophisticated architectural approach that balances the ease of web interfaces with the security of blockchain-based escrow and the depth of Telegram’s native analytical data. The objective is the construction of a Minimum Viable Product (MVP) that bridges the gap between channel owners and advertisers through a trustless, automated, and verified environment.Marketplace Dynamics and the Dual-Sided Entry ModelA functional advertising marketplace must cater to two primary user classes: channel owners seeking to monetize their influence and advertisers looking for targeted reach. The marketplace architecture is designed to support these parallel entry points, eventually converging into a unified transactional workflow that manages everything from discovery to financial settlement.Channel Owner Onboarding and ManagementFor channel owners, the listing process involves more than simple data entry. It requires a formal linkage between the marketplace and the Telegram channel. Owners list their channels by providing the unique identifier or username, which the system validates using the getChat method. A critical component of this onboarding is the addition of the marketplace’s administrative bot to the channel. This bot acts as the primary interface for data extraction and automated content delivery.The administrative rights granted to the bot must be specific. To fulfill the requirements of the marketplace, the bot necessitates permissions to post messages and edit them, enabling both the initial publication of ads and the verification of their persistence. Furthermore, the marketplace must support complex administrative flows, such as those involving Public Relations (PR) managers. In many professional settings, a channel is managed by a team rather than a single individual. The architecture facilitates this by allowing the primary owner to designate multiple users within the marketplace interface to manage a single channel’s listings and deal flow.Administrative RightRequirement LevelPurpose in Marketplacecan_post_messagesMandatoryExecution of auto-posting after creative approvalcan_edit_messagesMandatoryVerification of delivery and potential post-updatescan_delete_messagesOptionalAdministrative cleanup of expired or disputed postscan_invite_usersOptionalIntegration with referral and growth trackingcan_restrict_membersNot RequiredAdministrative control over channel subscribers Advertiser Campaign Briefing and DiscoveryOn the opposing side of the marketplace, advertisers initiate the process by creating detailed campaign briefs. These briefs serve as the "Request for Proposal" (RFP) to which channel owners can apply. A brief includes the creative assets, targeting preferences, and budget constraints. The marketplace provides a discovery interface where these requests are indexed and made searchable for influencers.The discovery mechanism for both channel listings and advertiser requests is underpinned by a practical filtering system. This system allows users to navigate the inventory based on quantitative metrics. For advertisers, the primary filters revolve around reach, subscriber count, and pricing. For channel owners, filters might focus on campaign duration, niche relevance, and the reputation of the advertiser.Filter TypeMetricImplementation LogicQuantitativeSubscribersRange-based filtering using getChatMemberCount dataQuantitativeAverage ViewsCalculated from the last 30 days of broadcastStatsDemographicLanguageFiltering by dominant subscriber language (e.g., "en", "ru")FinancialPrice (TON)Range-based filtering for specific ad formatsQualityPremium RatioRatio of Premium users to total subscribers Unified Workflow Convergence and Message-Based InteractionWhile the discovery and management of listings occur within the rich UI of the Telegram Mini App, the negotiation and real-time communication between parties are offloaded to a text bot. This architectural decision respects the platform's native communication patterns and ensures that users are notified of updates even when the Mini App is closed. The bot serves as a notification layer, delivering alerts when a new application is received, when a creative is ready for review, or when an escrow payment has been secured.The convergence of these paths leads into a standardized state machine that manages the deal lifecycle. Every interaction—whether a negotiation on price or a revision of a creative draft—is recorded in the central database and synchronized across the Mini App and the text bot.Multi-User Administrative Flows and Rights VerificationIn professional advertising, the person listing the channel might not be the person authorized to approve financial transactions. The system architecture supports a PR manager flow where multiple users can be associated with a single channel's administrative panel. These users inherit rights based on their roles within the marketplace. For instance, a "Creative Lead" might only have rights to submit drafts, while a "Financial Manager" holds the authority to release funds from escrow.A critical security requirement is the re-verification of administrative rights on all important operations, particularly those involving financial movements. Even if a user was an admin when the channel was listed, the system must perform a real-time check using the getChatMember method before any funds are released or ads are posted. This prevents "ghost admin" scenarios where a former employee or compromised account retains access to the marketplace's financial controls.RoleMarketplace PermissionChannel Admin RequirementOwnerAll OperationsMandatory (Creator Status)PR ManagerDeal Negotiation, Creative ReviewRequired (Administrator Status)EditorCreative DraftingNot Mandatory for MarketplaceFinancial OpFund Release, Escrow ApprovalMandatory (Administrator Status) Extraction of Verified Channel AnalyticsA cornerstone of the marketplace is the provision of verified statistics directly from Telegram's infrastructure. This eliminates reliance on potentially forged screenshots and provides advertisers with a clear view of the audience they are purchasing. Fetching these statistics requires a sophisticated integration with both the Telegram Bot API and the MTProto protocol, as standard bot accounts have limited access to deep analytical data.The MTProto Analytics ProtocolTo retrieve detailed statistics, the marketplace's backend must interact with the Telegram API using an authorized account or a bot with specific administrative privileges. The process begins with channels.getFullChannel, which returns a channelFull object containing the can_view_stats flag. If this flag is true, the system can then query stats.getBroadcastStats to retrieve a comprehensive set of metrics.These statistics are provided over specific periods, typically depending on the channel's activity levels. The returned stats.broadcastStats constructor includes both absolute values and graphical data represented in the StatsGraph format.MetricSource FieldDescriptionSubscribersfollowersAbsolute follower count at the start and end of the periodPost Reachviews_per_postAverage view count per post during the periodShare Reachshares_per_postAverage number of times posts were sharedReaction Densityreactions_per_postAverage number of reactions per publicationStory Reachviews_per_storyAnalytics specific to the Story format Visualization and Parsing of Graph DataThe data for language distributions, growth trends, and view sources is returned as JSON-encoded graphs within the json field of the statsGraph object. Each graph consists of a x-axis (UNIX timestamps in milliseconds) and various data columns mapped to labels. The marketplace backend must parse these structures to display them within the Mini App’s dashboard.The languages_graph is particularly vital for advertisers, as it provides a pie chart or area graph representing the linguistic makeup of the channel's audience. Similarly, the new_followers_by_source_graph helps identify if a channel's growth is organic (via search) or driven by external links, which is a key indicator of audience quality.Telegram Premium StatisticsWith the growth of Telegram Premium to over 10 million users, advertisers increasingly prioritize channels with a high ratio of Premium subscribers, as these users are often considered higher-value targets. While the official broadcastStats schema provides a broad view, detailed audience segmentation—distinguishing between free and paid users—is a key feature of the advanced analytics suite. The marketplace utilizes these metrics to calculate a "Premium Score" for each channel, allowing advertisers to filter for premium-heavy audiences.Premium MetricImportanceData HandlingPremium RatioHighPercentage of subscribers with active Premium statusEngagement by TierMediumComparative interaction rates between Premium and non-Premium usersGrowth by TierLowTracking if new followers are predominantly Premium Ad Formats and Flexible Pricing ArchitecturesThe marketplace is designed to accommodate a variety of advertising formats, recognizing that the "one size fits all" approach to channel posts is insufficient for modern influencer marketing. While the MVP prioritizes the standard channel post, the system architecture is built to support a "free format" model where pricing can be defined for any ad type the channel owner deems suitable.Supported Ad Types and SpecificationsThe system distinguishes between several standard ad formats while allowing for custom entries. Each format is associated with a specific Telegram action and verification logic.Standard Channel Post: A conventional message containing text, media, and buttons. It is the most common format and uses the sendMessage method for auto-posting.Forward/Repost: The forwarding of a message from the advertiser's channel or bot. This is effective for driving traffic directly to another Telegram entity and is handled via the forwardMessage method.Story Ad: A 24-hour temporary post in the channel's story feed. This is a high-engagement format that leverages the sendStory method and requires specialized stats verification through stats.getStoryStats.Flexible Formats: Owners can define custom formats, such as "Pinned Post for 48 Hours" or "Series of 3 Posts," with pricing set manually for each.Ad FormatPricing ModelPublication MethodVerification MethodPostFixed / CPMsendMessagegetChatHistory checkForwardFixedforwardMessageedited_channel_post webhookStoryFixedsendStorystats.getStoryStats APICustomVariableManual / AutomatedAdmin Log monitoring Dynamic Pricing LogicPricing is not static. Channel owners can set different prices based on the format and the "slot" the ad occupies. For example, a post might have a different price if it is scheduled for a peak engagement window. The system maintains a pricing matrix for each channel, which is exposed to advertisers during the discovery phase. This data is stored in the Ad_Formats table and is regularly updated by the owner to reflect market demand and channel growth.The Escrow Deal Flow and Transactional SecurityThe most critical component of the marketplace is the escrow-style deal flow. In a peer-to-peer environment, trust is the primary barrier to transaction. By implementing an escrow mechanism, the marketplace acts as a neutral third party that holds funds until the conditions of the advertising contract are fulfilled.Blockchain-Based Escrow ImplementationFollowing the 2025 Telegram guidelines, the marketplace exclusively utilizes the TON blockchain for financial operations. The integration is performed via TON Connect, ensuring that users maintain control of their private keys through compliant wallets like Tonkeeper or @wallet.To maximize security and transparency, the marketplace recommends the use of a unique smart contract address for each individual deal. This "one deal, one contract" approach prevents the co-mingling of funds and allows for granular tracking of a deal's financial state. Alternatively, a per-user wallet strategy can be employed, though it requires more complex internal accounting.Escrow StateDescriptionBlockchain EventTriggerUninitializedContract address generated; awaiting depositNoneDeal creation in DBFundedAdvertiser has deposited TON/USDTTransaction confirmationTON Connect signature In ProgressCreative approved; ad scheduled/postedNoneWorkflow transitionVerifyingAd is live; system checking for persistenceNoneHeartbeat check CompletedPost period ended; funds released to ownerRelease transactionOracle / Bot verificationCancelledDeal failed; funds returned to advertiserRefund transactionTimeout / Mutual cancel Lifecycle Controls and Lifecycle ManagementA deal is more than a simple transaction; it is a process with multiple potential failure points. The system implements basic lifecycle controls to ensure that deals do not stall indefinitely.Auto-Cancel/Timeout: If a channel owner does not accept an application within a set timeframe (e.g., 48 hours), the deal is automatically cancelled. Similarly, if an advertiser does not approve a draft creative or request edits within a specific window, the deal may time out, and funds are either returned or a dispute is flagged.Dispute Resolution: If the auto-posting fails or if the post is deleted prematurely, the system holds the funds and opens a dispute. This allows an administrative arbiter to review the evidence (provided by the bot's logs) and determine whether to issue a full refund, a partial refund, or a release to the owner.The mathematical logic for time-based cancellations can be expressed as:$$T_{expiry} = T_{creation} + \Delta T_{max\_latency}$$
where $\Delta T_{max\_latency}$ is the configured threshold for that specific stage of the workflow.Creative Approval Workflow and Verification LoopThe creative approval process is designed as a clear loop that balances the advertiser's requirements with the channel owner's editorial control. This loop is essential for maintaining the quality of content within the Telegram ecosystem.The Sequential WorkflowThe workflow is structured to move forward only upon mutual consent at each stage. This ensures that by the time an ad is posted, both parties have explicitly agreed to the content and the schedule.Brief Submission: The advertiser submits the initial preferences and creative assets.Acceptance/Rejection: The channel owner reviews the brief. If rejected, the deal is closed immediately. If accepted, the state moves to "Drafting".Drafting and Submission: The channel owner creates the actual Telegram message (including formatting, media, and links) and submits it for review. The marketplace allows the owner to "preview" how the post will look in a Telegram chat.Review and Iteration: The advertiser receives a notification via the text bot to review the draft. They can either approve the creative or request specific edits. The system tracks the number of revision rounds to prevent abuse.Final Approval and Locking: Once approved, the creative is "locked." No further edits can be made by either party. The system then queues the message for auto-publication at the agreed-upon time.Auto-Posting and Persistence VerificationThe final stage of the workflow is the execution of the ad. The marketplace's backend orchestrates the publication through the administrative bot. After the message is sent, the bot captures the message_id and stores it as proof of delivery.However, the bot's job does not end with publication. It must verify that the creative stays in the channel for the agreed-upon time (e.g., "Top 1 for 24 hours"). This is challenging because the Telegram Bot API does not send proactive "message deleted" updates for channels. The system employs a "heartbeat" verification strategy:Polling Method: Every hour, the bot attempts to fetch the post status or forward the message to a private "Audit Chat." If the forwarding fails with an error indicating the message no longer exists, the system flags a deletion.Admin Log Monitoring: Via MTProto, the system can periodically check the GetAdminLogRequest. This provides a definitive history of all deletions and edits within the last 48 hours, allowing the system to verify if the post was tampered with.Only after the verification period has passed without incident are the funds released from the escrow smart contract to the channel owner's wallet.System Design and Backend ArchitectureThe backend is the primary focus of the marketplace's engineering efforts. It must handle concurrent sessions, blockchain state synchronization, and real-time communication with Telegram's various APIs.Infrastructure ComponentsThe system is composed of several specialized services that interact to maintain the marketplace's state.The API Gateway: Handles requests from the Mini App and external integrations.The Bot Engine: Manages all interactions with the Telegram Bot API, including message delivery and webhook handling.The MTProto Worker: A specialized service using libraries like Telethon or TDLib to fetch deep analytics and monitor admin logs.The Blockchain Indexer: Monitors the TON blockchain for transaction confirmations related to the escrow contracts.The Orchestrator: Manages the state transitions of deals and creative workflows, ensuring that timers and automated actions are executed correctly.API Communication: REST vs. WebSocketThe choice between REST and WebSocket (WSS) APIs is a critical architectural decision for a real-time marketplace. Each protocol serves a specific purpose in the system.REST API Analysis:
REST is the standard for most marketplace operations. It is stateless, easily cacheable, and highly scalable. It is ideal for fetching listings, user profiles, and historical analytics where the data does not change every few seconds.WebSocket API Analysis:
WebSockets provide a persistent, bi-directional connection that is essential for live interaction. In an advertising marketplace, real-time updates are necessary for the creative approval workflow and live negotiation. Using WebSockets ensures that an advertiser sees a "Creative Submitted" update the instant the owner clicks "Send," without the latency of polling.FeatureREST APIWebSocket API (WSS)Communication ModeRequest-ResponseBi-directional / Full DuplexStatefulnessStatelessStatefulLatencyHigher (Handshake overhead)Ultra-low (Persistent link) PerformanceGood for bulk data98.5% faster for live updates Mobile StabilityHigh (Robust to drops)Medium (Requires reconnection logic) Primary Use CaseSearch, Filters, ProfilesNegotiation, Approval, Status AlertsArchitectural Recommendation:
The marketplace utilizes a hybrid approach. A REST API handles the bulk of the "Static" marketplace data, while a WebSocket layer is established specifically for "Active" deal sessions. This provides the best of both worlds: the scalability of REST for browsing and the responsiveness of WSS for execution.API Endpoints and Data TemplatesTo facilitate the development of the frontend and external integrations, the backend exposes a suite of API endpoints. These templates define the data structures used for the marketplace's core functions.Marketplace and Channel DiscoveryEndpoint: GET /v1/marketplace/searchPurpose: Search for available advertising inventory.Request Template:JSON{
  "filters": {
    "min_subscribers": 10000,
    "max_price": 50.0,
    "language": ["en", "ru"],
    "categories": ["crypto", "finance"]
  },
  "sort": "engagement_rate_desc",
  "limit": 20,
  "offset": 0
}
Response Template:JSON{
  "results": [
    {
      "channel_id": "@example_crypto",
      "title": "Crypto Insights",
      "verified_stats": {
        "subscribers": 45000,
        "avg_views": 15000,
        "engagement_rate": 0.035
      },
      "pricing": {
        "post": 25.5,
        "story": 15.0
      }
    }
  ],
  "total_count": 124
}
Deal Lifecycle and Escrow ManagementEndpoint: POST /v1/deals/initiatePurpose: Start a new escrow-protected deal.Request Template:JSON{
  "advertiser_id": "user_789",
  "channel_id": "@example_crypto",
  "format": "post",
  "agreed_price": 25.5,
  "brief_id": "brief_abc123"
}
Response Template:JSON{
  "deal_id": "deal_555",
  "escrow_address": "EQDooLp9q93EV-lajwbvfOPH01SbluAFxMHvQXjM9QUxHFKN",
  "status": "AWAITING_DEPOSIT",
  "expires_at": "2026-02-15T10:00:00Z"
}
Creative Approval and Auto-PostingEndpoint: PATCH /v1/deals/{id}/approvePurpose: Advertiser approves the draft creative.Request Template:JSON{
  "approval_signature": "sig_xyz...",
  "scheduled_time": "2026-02-16T14:00:00Z"
}
Response Template:JSON{
  "status": "QUEUED_FOR_PUBLISHING",
  "message": "Creative approved and locked for schedule."
}
Database Schema and IntegrityThe database is designed to manage the high complexity of a multi-user, multi-channel marketplace. It ensures data integrity and supports the re-verification of administrative rights at every critical step.Core Table StructureUsers Table: Stores primary identity, linked Telegram account, and roles within the marketplace.Channels Table: Contains metadata for each listed channel, its verification status, and the marketplace bot's admin state.Admins Table: A many-to-many relationship mapping users to channels with specific permissions (e.g., "Full Owner" vs. "PR Manager").Briefs Table: Stores the creative assets and requirements for advertiser requests.Deals Table: The central state table tracking the current status of every negotiation and escrow transaction.Transactions Table: Records all blockchain interactions and escrow movements for auditing.TableKey FieldsConstraintsUserstg_id, wallet_addr, roleUnique tg_idChannelschannel_id, owner_id, is_verifiedUnique channel_idAd_Formatschannel_id, type, price_tonComposite PK (channel_id, type)Dealsdeal_id, status, amount_tonForeign keys to Channels & BriefsVerificationdeal_id, last_check, post_existsLink to Deals status Verification of Session and IdentityTo ensure that only authorized admins can perform financial operations, the system implements a "Verification Layer." Before any endpoint related to funding or release is executed, the backend performs a real-time check:Session Check: Validating the user's initData from the Mini App.Permission Check: Consulting the Admins table for the user's role on the channel.Telegram Check: Invoking getChatMember to confirm the user is still an active administrator in the actual Telegram channel with the necessary rights.Operational Strategy and Future ConsiderationsThe development of the marketplace MVP is only the first phase of a long-term product roadmap. The architecture is designed to be extensible, allowing for the addition of more complex features as the user base grows.Scalability and Multi-Cloud ArchitectureAs the number of concurrent deals and real-time monitoring tasks increases, the system must scale horizontally. A multi-cloud data architecture provides resilience, allowing the backend to distribute workloads across multiple providers to avoid downtime and minimize operational complexity. The use of tools like Kubernetes ensures that the bot engine and MTProto workers can be scaled independently based on current traffic demands.Advanced Analytics and Machine LearningFuture iterations of the marketplace will incorporate deeper audience sentiment analysis. By leveraging the reactions_by_emotion_graph from Telegram, the system can provide advertisers with insights into the emotional resonance of their ads. Machine learning models can be trained on historical deal data to suggest optimal pricing and posting times for different niches, maximizing the ROI for advertisers and the earnings for channel owners.Open Source and Community EngagementThe codebase is structured to be clean, modular, and ready for open-source distribution. This not only invites community contributions but also provides transparency regarding the escrow logic and data extraction methods. By adhering to standardized practices for Telegram Mini App development—including pre-configured authentication flows and robust error handling—the project serves as a reference implementation for future decentralized marketplaces on the platform.Synthesis and ConclusionThe construction of an MVP advertising marketplace within the Telegram Mini App framework represents a paradigm shift in how influencer marketing is executed. By integrating verified channel statistics with a secure, blockchain-based escrow system, the platform resolves the inherent trust issues that have historically plagued peer-to-peer advertising. The architectural decision to utilize a hybrid REST and WebSocket API ensures that the marketplace is both responsive and scalable, while the dedicated text bot interface maintains a native user experience for negotiation and alerts.The detailed creative approval workflow, combined with automated persistence checks via MTProto, guarantees that advertisers receive the value they purchase, while channel owners benefit from a streamlined, automated monetization process. As Telegram continues to expand its feature set—particularly in the realm of Premium analytics and blockchain interoperability—this marketplace is positioned to become a foundational pillar of the platform’s emerging decentralized economy. The strict adherence to administrative rights verification on all financial operations ensures that the system remains secure and professional, catering to the needs of individual influencers and large-scale PR management teams alike. In summary, the marketplace architecture provides a trustless bridge between content creators and brand builders, leveraging the best of web technology and blockchain transparency.